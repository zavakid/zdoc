---
layout: post
title: 模式学习笔记-体系结构模式-2
categories:
  模式
tags:
  模式
  架构
---

体系结构模式定义了软件的基础结构。比如 MVC，比如分布式代理模式。
此类模式并非只能使用一种，可以组合起来使用。这取决于项目所面临的实际情况。
比如你在开发一个项目，需求特点是：1.有用户界面；2.有灵活的异构系统。
这时你可能会选择 MVC 和 基于分布式代理 这样的体系结构组合来定下你的模式基调。

### 一般的体系结构模式有：

* 层 Layer
* 管道/过滤器 Pipes and Filters
* 黑板 Blackboard
* 代理者 Broker
* MVC
* 表示-抽象-控制 PAC
* 微核 Microkernel
* 映像 Reflection

### 可以对这些模式进行分类：

<ul>
<li>从混沌到结构（层，管道/过滤器，黑板）</li>
<li>分布式系统（代理者）</li>
<li>交互性系统（MVC，表示-抽象-控制）</li>
<li>适应性系统（微核，映像）</li>
</ul>

### 从混沌到结构
一开始接受需求的时候，就是一篇混沌的时候，因为这时候系统还没有被设计，也没有被整理。我们需要一个思路将整个系统划分为多个组成部分。

分层是使用比较多的一种模式，将系统分解成有层次概念的部分。很多我们经常接触的架构，都已经分层了。比如TCP、计算机中的存储体系层次。

管道/过滤器则侧重数据流之间的定义，尽管层之间也需要数据流。但管道/过滤器则相对灵活，他们可以互相组合，调整顺序。比如，unix的管道模型。

黑板模式适用于一些为止领域中的系统，（[参考wiki][black borad wiki]）,比如人工智能等领域。有兴趣的读者可以研究下。

### 分布式系统
在分布式系统中，应用程序开发人员往往有几个需求：

<ol>
<li>简单，进程间的通信和方法调用，应该就像在本地通信和调用一样。</li>
<li>透明，不需要知道具体节点的位置/ip，这样就为节点的迁移/切换提供了可能性。</li>
<li>安全，不会因为一个节点挂了，就导致我不能访问，应该有相应的节点来继续提供服务。</li>
</ol>

代理者模式（broker）是解决者方面问题的模式。
代理者模式主要有几个概念：客户端，客户端代理，服务端，服务端代理，桥接。
请求的流程是：
<ol>
<li>客户端向客户端代理调用方法</li>
<li>客户端代理将请求发向服务端代理者</li>
<li>服务端代理者向服务器发出方法调用</li>
<li>服务器返回结构，服务端代理者返回给客户端代理者，客户端代理者返回客户端。</li>
<li>如果此时服务器没有服务，那么服务端代理者可以转发请求，请求其他的服务区代理者。这就是桥接。</li>
</ol>

### 交互式系统
这里我注重看了下 MVC 的优缺点，对与PAC，有兴趣的可以查看[pac的wiki][pac wiki]。

MVC 的优点：
<ol>
<li>同一模型可以有多个视图</li>
<li>通过观察者模式，可以让模型的变更传递到所有关注此模型的视图中。</li>
<li>MVC三组件可以任意替换实现</li>
</ol>

MVC缺点：
<ol>
<li>复杂性增加，相比于简单的逻辑界面揉在一起写，复杂度有所增加</li>
<li>模型更新需要更新相应视图，造成更新风暴 (不过在基于web编程中，很少人会这么做，特别用户打开多tab的时候)</li>
<li>视图和控制器严重依赖模型，一旦模型结构有所变更，视图和控制器也需要跟着变更</li>
</ol>

### 适应性系统
操作系统就是非常典型的微核模式。微核模型非茶适用于需要满足不同平台和个性化定制的需求。
一般微核都提供了可插拔的环境，像Linux的内核，可以任意加载模块。

而映像模式也是为了解决以上的问题，不同的是其使用了另一种方式，即提供了运行时的元信息。也就是所谓的映像。

模式这东西，如果不用，没有吃过亏，相信对其好处很难体会得到。
先对这上面的模式有个印象，待到后续有场景时，起码也能想到能有相应的模式去解决。


  [black borad wiki]: http://en.wikipedia.org/wiki/Blackboard_system
  [pac wiki]:http://en.wikipedia.org/wiki/Presentation-abstraction-control
